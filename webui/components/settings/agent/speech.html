<html>
  <head>
    <title>Speech</title>
  </head>

  <body>
    <div x-data>
      <template x-if="$store.settings.settings">
        <div>
          <div class="section-title">Speech</div>
          <div class="section-description">
            Voice transcription and speech synthesis settings.
          </div>

          <div class="field field-full">
            <div class="field-label">
              <div class="field-title">Microphone device</div>
              <div class="field-description">Select the microphone device to use for speech-to-text.</div>
            </div>
            <div class="field-control">
              <x-component path="/settings/speech/microphone.html"></x-component>
            </div>
          </div>

          <div class="field">
            <div class="field-label">
              <div class="field-title">Speech-to-text model size</div>
              <div class="field-description">Select the speech-to-text model size</div>
            </div>
            <div class="field-control">
              <select x-model="$store.settings.settings.stt_model_size">
                <template x-for="option in $store.settings.additional?.stt_models" :key="option.value">
                  <option :value="option.value" :selected="option.value === $store.settings.settings.stt_model_size" x-text="option.label"></option>
                </template>
              </select>
            </div>
          </div>

          <div class="field">
            <div class="field-label">
              <div class="field-title">Speech-to-text language code</div>
              <div class="field-description">Language code (e.g. en, fr, it)</div>
            </div>
            <div class="field-control">
              <input type="text" x-model="$store.settings.settings.stt_language" />
            </div>
          </div>

          <div class="field">
            <div class="field-label">
              <div class="field-title">Microphone silence threshold</div>
              <div class="field-description">Silence detection threshold. Lower values are more sensitive to noise.</div>
            </div>
            <div class="field-control">
              <input type="range" min="0" max="1" step="0.01" x-model.number="$store.settings.settings.stt_silence_threshold" />
              <span class="range-value" x-text="$store.settings.settings.stt_silence_threshold"></span>
            </div>
          </div>

          <div class="field">
            <div class="field-label">
              <div class="field-title">Microphone silence duration (ms)</div>
              <div class="field-description">Duration of silence before the system considers speaking to have ended.</div>
            </div>
            <div class="field-control">
              <input type="number" x-model.number="$store.settings.settings.stt_silence_duration" />
            </div>
          </div>

          <div class="field">
            <div class="field-label">
              <div class="field-title">Microphone waiting timeout (ms)</div>
              <div class="field-description">Duration of silence before the system closes the microphone.</div>
            </div>
            <div class="field-control">
              <input type="number" x-model.number="$store.settings.settings.stt_waiting_timeout" />
            </div>
          </div>

          <div class="field">
            <div class="field-label">
              <div class="field-title">Enable Kokoro TTS</div>
              <div class="field-description">
                Enable higher quality server-side AI (Kokoro) instead of browser-based text-to-speech.
              </div>
            </div>
            <div class="field-control">
              <label class="toggle">
                <input type="checkbox" x-model="$store.settings.settings.tts_kokoro" />
                <span class="toggler"></span>
              </label>
            </div>
          </div>
        </div>
      </template>
    </div>
  </body>
</html>
